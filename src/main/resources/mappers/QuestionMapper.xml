<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="practical.llm.question.mapper.QuestionMapper">

    <resultMap id="QuestionMap" type="practical.llm.question.domain.Question">
        <id     property="questionId"       column="question_id"/>
        <result property="userId"           column="user_id"/>
        <result property="documentId"       column="document_id"/>
        <result property="questionText"     column="question_text"/>
        <result property="lang"             column="lang"/>
        <result property="genPromptText"    column="gen_prompt_text"/>
        <result property="genPromptParams"  column="gen_prompt_params"/>
        <result property="createdAt"        column="created_at"/>
    </resultMap>

    <insert id="insertBatch">
        INSERT INTO tb_question
        (user_id, document_id, question_text, lang, gen_prompt_text, gen_prompt_params)
        VALUES
        <foreach collection="list" item="q" separator=",">
            (#{q.userId}, #{q.documentId}, #{q.questionText}, #{q.lang},
            #{q.genPromptText}, #{q.genPromptParams})
        </foreach>
    </insert>

    <select id="findByDocumentId" resultMap="QuestionMap">
        SELECT * FROM tb_question
        WHERE document_id = #{documentId}
        ORDER BY question_id DESC
    </select>

    <select id="findByUserId" resultMap="QuestionMap">
        SELECT * FROM tb_question
        WHERE user_id = #{userId}
        ORDER BY question_id DESC
    </select>

</mapper>